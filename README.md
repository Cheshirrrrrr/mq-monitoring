# mq-monitoring
Library for monitoring of Monique components.

## Компонент

Мониторинговый компонент, ответственный за сбор и запись мониторинговых сообщений в кэш, запускается следующей последовательностью команд:

```
stack build
stack exec mq-monitoring
```

## REST-ручка

Вместе с мониторинговым компонентом в фоне поднимается ручка, которая общается с внешним миром по REST-протоколу и предоставляет возможность понять, какие компоненты системы сейчас работают.

### Порт

По умолчанию ручка поднимается на **3000** порту. Чтобы изменить порт, нужно соответствующим образом поменять поле **port** секции "params -> mq_monitoring_handler" в **config.json**:

```
"params": {
  "mq_monitoring_handler": {
    "port": <мой_порт>
  }
}
```

### Использование

Ручка предоставляет пользователю возможность по GET запросу получать мониторинговые сообщения.

У запроса **monitoring** есть следующие параметры:

* **last** является не принимающим никаких параметров флагом; по данному флагу будут возвращены все самые актуальные мониторинговые сообщения от каждого из компонентов системы.

Запрос формируется следующим образом:

```
# Последнее мониторинговое сообщение от каждого из компонентов
<хост>:<порт>/v1/monitoring?last
```